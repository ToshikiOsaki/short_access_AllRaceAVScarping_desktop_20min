# Netkeiba 平均タイム取得アプリ (アクセス短縮版)

## 概要

このアプリケーションは、[netkeiba.com](https://db.netkeiba.com/?pid=race_search_detail) のデータベースから、指定した様々な条件に合致する競馬のレースデータをスクレイピングし、平均タイムを算出してExcelファイルに出力するデスクトップツールです。



## 特徴

- **直感的なGUI**: チェックボックスや入力欄を使って、誰でも簡単に取得したいレース条件を指定できます。
- **複数期間の自動集計**: 「5年間のデータを1年ずつスライドして集計」といった複雑な集計も一度の操作で実行できます。
- **高速なデータ取得**:
    - 存在しないレース条件へのアクセスを事前にフィルタリングし、無駄な通信を削減します。
    - 全期間のデータを一度に取得し、プログラム内部で年ごとに集計するため、Webサイトへのリクエスト回数を最小限に抑えます。
- **整形済みExcel出力**: 取得したデータを条件ごとに行を揃え、比較しやすい形式でExcelファイルに出力します。

## 動作環境

- Python 3.x
- 必要なPythonライブラリ (詳細は `requirements.txt` を参照)
    - `requests`
    - `beautifulsoup4`
    - `openpyxl`
    - `lxml`

## 準備

1.  **リポジトリのクローンまたはダウンロード**
    ```bash
    git clone https://github.com/ToshikiOsaki/short_access_AllRaceAVScarping_desktop_20min.git
    cd short_access_AllRaceAVScarping_desktop_20min
    ```

2.  **必要なライブラリのインストール**
    リポジトリに `requirements.txt` という名前のファイルを作成し、以下の内容を記述してください。

    **`requirements.txt`**
    ```txt
    requests
    beautifulsoup4
    openpyxl
    lxml
    ```

    その後、ターミナル（コマンドプロンプト）で以下のコマンドを実行して、ライブラリを一度にインストールします。
    ```bash
    pip install -r requirements.txt
    ```

## 使い方

1.  **プログラムの実行**
    ターミナル（コマンドプロンプト）で以下のコマンドを実行して、アプリケーションを起動します。
    ```bash
    python AIと手動開発ハイブリッド短縮版競馬平均算出デスクトップアプリ完成版ToshikiOsaki.py"
    ```

2.  **条件の設定**
    - **トラック、競馬場、馬場状態、クラス、距離**: 取得したい条件のチェックボックスをオンにします。
    - **開始年 / 終了年**: データを取得したい全体の期間を指定します。（例: 2015年～2024年）
    - **開始月 / 終了月**: 上記の期間内で、毎年何月から何月までのデータを対象とするかを指定します。
    - **集計期間(年)**: 平均タイムを算出する期間の長さを年単位で指定します。（例: `5` を指定すると5年分のデータで1つの平均を計算）
    - **スライド間隔(年)**: 集計期間を何年ずつずらしていくかを指定します。（例: `1` を指定すると、2015-2019年、2016-2020年...のように1年ずつずれます）
    - **保存先ファイルパス**: 結果を出力するExcelファイルの保存場所とファイル名を指定します。

3.  **実行と中断**
    - **[スクレイピング開始]**: 設定した条件でデータ取得を開始します。
    - **[中断]**: 実行中の処理を安全に停止します。現在処理中の条件が完了次第、プログラムは停止します。

4.  **結果の確認**
    - 処理が完了すると、指定したパスにExcelファイルが生成されます。
    - 最初に各期間のデータが書き込まれた後、自動的に条件ごとに行が揃えられた状態に整形され、ファイルが上書き保存されます。

## 注意事項

- 本プログラムはスクレイピングを利用して情報を取得します。対象サイトの利用規約を遵守し、サーバーに過度な負荷をかけないよう、節度を持って使用してください。
- Webサイトの仕様が変更された場合、本プログラムは正常に動作しなくなる可能性があります。
- 本プログラムの利用によって生じたいかなる損害についても、作成者は一切の責任を負いません。自己責任でご利用ください。




